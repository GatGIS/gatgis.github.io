/* Mobile-first layout and modern touch-friendly styles */
:root{
  --bg:#ffffff;
  --muted:#f6f6f6;
  --accent:#007AFF;
  --danger:#e74c3c;
  --text:#111;
  --panel-gap:8px;
  --touch-size:50px;
  --font-base:16px;
  --panel-height: 35vh; /* default; JS will increase if needed */
  --bottom-spacer-height: 56px; /* adjust as needed */
}

/* Always-visible bottom spacer (DOM element #bottomSpacer) */
#bottomSpacer {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: var(--bottom-spacer-height);
  pointer-events: none; /* allow interactions through it */
  z-index: 9999; /* stays above most UI */
  background: linear-gradient(to top, rgba(0,0,0,0.06), rgba(0,0,0,0)); /* subtle separation */
}

/* Constrain the whole app to 98% of the viewport height so 2% remains free at the bottom */
html, body, #app {
  height: 98vh;      /* leave 2vh free at bottom */
  min-height: 98vh;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* Ensure map area and panel respect the reduced app height */
.map-area {
  height: calc(98vh - var(--panel-height));
  min-height: 120px;
  transition: height 260ms cubic-bezier(.22,.9,.25,1);
  width: 100%;
}

.panel-area {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: var(--panel-height);
  /* keep the panel inside the 98vh app area */
  max-height: calc(98vh);
  transition: height 200ms ease;
  box-shadow: 0 -6px 18px rgba(0,0,0,0.08);
  background: linear-gradient(180deg, rgba(255,255,255,0.98), #fff);
  padding: 10px 12px;
  padding-bottom: calc(var(--bottom-spacer-height) + 12px); /* keep content above spacer */
  box-sizing: border-box;
  z-index: 1300;
  display: flex;
  flex-direction: column;
  gap: 8px;
  overflow: hidden;
}

/* When results open allow scrolling inside the panel */
#app.results-open { --panel-height: 70vh; }
#app.results-open .panel-area { overflow: auto; }

/* Bottom spacer overlay (always visible above the panel) */
#bottomSpacer {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: var(--bottom-spacer-height);
  pointer-events: none; /* allow interactions through it */
  z-index: 9999; /* higher than .panel-area so it remains visible when panel expands */
  background: linear-gradient(to top, rgba(0,0,0,0.08), rgba(0,0,0,0)); /* subtle visual gap */
}

/* header now contains buttons on the right */
.mosys-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  position: relative;
}

/* top actions (buttons in header) */
.top-actions {
  display:flex;
  gap:8px;
  align-items:center;
}

/* small variant if there's little space */
.top-actions .mosys-btn { min-height:44px; padding:8px 10px; }

/* ensure controls can wrap and shrink */
.controls { display:flex; gap:8px; width:100%; flex-wrap:wrap; align-items:center; }
.controls input[type="text"]{ flex:1 1 calc(50% - 8px); min-width:0; height:48px; padding:10px; box-sizing:border-box; }

/* keep buttons row but now not required to be at bottom */
.buttons-row { display:flex; gap:10px; width:100%; }

/* webAnswer wraps and is scrollable inside panel when expanded */
.mosys-result { word-break: break-word; white-space: pre-wrap; overflow-wrap: anywhere; font-size:14px; padding-top:6px; }

/* table compact */
.mosys-table { width:100%; border-collapse:collapse; font-size:14px; }
.mosys-table td { padding:10px 8px; border-bottom:1px solid #f2f2f6; }

/* Floating layer menu toggled by the Layers button */
.layer-menu {
  position: absolute;
  top: 48px;            /* below the header/top-actions */
  right: 12px;
  background: #ffffff;
  border: 1px solid rgba(0,0,0,0.06);
  padding: 8px 10px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  border-radius: 6px;
  z-index: 1400;
  min-width: 140px;
  font-size: 14px;
}
.layer-menu label { display: block; margin: 4px 0; cursor: pointer; }
/* ensure the floating menu is compact on small screens */
@media (max-width:420px){
  .controls input[type="text"] { flex-basis:100%; }
  .top-actions .mosys-btn { min-height:48px; padding:10px 12px; font-size:15px; }
  .layer-menu { right: 8px; left: 8px; top: 56px; min-width: auto; }
}

/* Map controls floating on top-right */
.map-controls {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 1400;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 6px;
  pointer-events: auto;
}

.map-controls .map-btn {
  background: #fff;
  border: 1px solid rgba(0,0,0,0.08);
  padding: 6px 10px;
  border-radius: 6px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  cursor: pointer;
  font-size: 13px;
}

.layer-menu {
  margin-top: 6px;
  background: #fff;
  border: 1px solid rgba(0,0,0,0.06);
  padding: 8px 10px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  border-radius: 6px;
  min-width: 150px;
  text-align: left;
}

/* Modern button styles for Drill/Refresh */
.mosys-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid transparent;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease;
  user-select: none;
  box-shadow: 0 2px 6px rgba(8,15,30,0.06);
  background: #fafafa;
}

.mosys-btn:active { transform: translateY(1px); }

/* Primary / Drill */
.mosys-btn.primary {
  background: linear-gradient(180deg,#2d8cff,#1b6fe6);
  color: #fff;
  box-shadow: 0 6px 18px rgba(27,111,230,0.18);
  border-color: rgba(27,111,230,0.18);
}
.mosys-btn.primary:hover { transform: translateY(-1px); }

/* Secondary / Refresh */
.mosys-btn.secondary {
  background: #fff;
  color: #223;
  border: 1px solid rgba(34,34,34,0.08);
  box-shadow: 0 4px 10px rgba(0,0,0,0.04);
}
.mosys-btn.secondary:hover { transform: translateY(-1px); }

/* small-screen tweaks */
@media (max-width:420px){
  :root { --bottom-spacer-height: 64px; }
  .mosys-btn { padding: 10px; font-size: 13px; border-radius: 8px; }
  #bottomSpacer { height: 22px; }
}